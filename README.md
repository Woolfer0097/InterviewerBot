# DevOps Mock Bot

Telegram-–±–æ—Ç –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∫ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è–º —Å –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–æ–π –≤–æ–ø—Ä–æ—Å–æ–≤.

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- Python 3.12
- aiogram 3
- async SQLAlchemy + asyncpg
- APScheduler
- PostgreSQL
- Docker Compose

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ `.env.example` –≤ `.env` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ:

```bash
cp .env.example .env
```

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env`:
```
BOT_TOKEN=your_telegram_bot_token
DATABASE_URL=postgresql+asyncpg://postgres:postgres@db:5432/devops_mock
TZ=Europe/Moscow
DAILY_HOUR=9
DAILY_MINUTE=0
QUESTIONS_PER_DAY=5
HIGH_SCORE_THRESHOLD=5

# AI API Key (optional, for hint generation)
GEMINI_API_KEY=your_gemini_api_key

# Whitelist (optional, –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞)
# –§–æ—Ä–º–∞—Ç: —Å–ø–∏—Å–æ–∫ Telegram ID —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é, –Ω–∞–ø—Ä–∏–º–µ—Ä: "123456789,987654321"
# –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ –∏–ª–∏ –ø—É—Å—Ç–æ - –¥–æ—Å—Ç—É–ø –æ—Ç–∫—Ä—ã—Ç –¥–ª—è –≤—Å–µ—Ö
WHITELIST_TG_IDS=123456789,987654321
```

### 2. –ó–∞–ø—É—Å–∫

```bash
docker compose up --build
```

### 3. –ò–º–ø–æ—Ä—Ç –≤–æ–ø—Ä–æ—Å–æ–≤

–¢–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞. –ü—Ä–æ—Å—Ç–æ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –≤–æ–ø—Ä–æ—Å—ã:

```bash
docker compose exec bot python scripts/import_questions.py /app/data.csv
```

## –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

- `/start` - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –≤–∫–ª—é—á–µ–Ω–∏–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏
- `/today` - –ø–æ–ª—É—á–∏—Ç—å 5 –≤–æ–ø—Ä–æ—Å–æ–≤ —Å–µ–π—á–∞—Å
- `/stats` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (–æ—Ç–≤–µ—á–µ–Ω–æ/–æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ/–æ—Å—Ç–∞–ª–æ—Å—å)
- `/reset_progress` - —Å–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å

## –§—É–Ω–∫—Ü–∏–∏

- **–ü–æ–¥—Å–∫–∞–∑–∫–∏ –æ—Ç –ò–ò**: –∫–Ω–æ–ø–∫–∞ "üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞" –ø–æ–¥ –∫–∞–∂–¥—ã–º –≤–æ–ø—Ä–æ—Å–æ–º –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø–æ–¥—Å–∫–∞–∑–∫—É —á–µ—Ä–µ–∑ Gemini/OpenRouter AI
- **–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –≤—ã–¥–∞—á–∞**: –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –ø–æ –æ–¥–Ω–æ–º—É, —Å–ª–µ–¥—É—é—â–∏–π —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –æ—Ç–≤–µ—Ç–∞/–ø—Ä–æ–ø—É—Å–∫–∞
- **–ö–Ω–æ–ø–∫–∞ "–ú–µ–Ω—é"**: –æ—Ç–º–µ–Ω—è–µ—Ç —Ç–µ–∫—É—â–µ–µ –æ—Ç–≤–µ—á–∞–Ω–∏–µ –Ω–∞ –≤–æ–ø—Ä–æ—Å
- **–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö**: –∫–æ–º–∞–Ω–¥—ã `/export_md` –∏ `/export_csv` –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤

## –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ PostgreSQL –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

–ï—Å–ª–∏ –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –æ—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ë–î:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ credentials**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `POSTGRES_USER` –∏ `POSTGRES_PASSWORD` –≤ `docker-compose.yml` —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å `DATABASE_URL` –≤ `.env` —Ñ–∞–π–ª–µ.

2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):
```bash
./scripts/fix_db_credentials.sh
```

3. **–†—É—á–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```bash
docker exec -it devops_mock_db psql -U postgres
ALTER USER postgres WITH PASSWORD 'postgres';
```

4. **–ü–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ volume** (‚ö†Ô∏è —É–¥–∞–ª–∏—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ):
```bash
docker compose down
docker volume rm interviewbot_postgres_data
docker compose up -d
./scripts/restore_database.sh  # –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç –≤–æ–ø—Ä–æ—Å—ã –∏–∑ data.csv
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–¢–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞. –î–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:

**–ë—ã—Å—Ç—Ä–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ** (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):
```bash
./scripts/restore_database.sh
```

**–†—É—á–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ**:
```bash
# –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã
docker compose exec bot python scripts/import_questions.py /app/data.csv
```

**–í–∞–∂–Ω–æ**: –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ credentials –≤ `docker-compose.yml` –∏ `.env` —Ñ–∞–π–ª–µ!

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞**: –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 09:00 MSK –±–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç 5 –≤–æ–ø—Ä–æ—Å–æ–≤
2. **–ü–æ–¥–±–æ—Ä–∫–∞**: 4 –≤–æ–ø—Ä–æ—Å–∞ —Å `freq_score > 5` + 1 –≤–æ–ø—Ä–æ—Å —Å `freq_score <= 5`
3. **–û—Ç–≤–µ—Ç—ã**: –Ω–∞–∂–º–∏—Ç–µ "‚úçÔ∏è –û—Ç–≤–µ—Ç–∏—Ç—å" ‚Üí –Ω–∞–ø–∏—à–∏—Ç–µ –æ—Ç–≤–µ—Ç —Ç–µ–∫—Å—Ç–æ–º ‚Üí –æ—Ç–≤–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
4. **–ü–æ–≤—Ç–æ—Ä**: –æ—Ç–≤–µ—á–µ–Ω–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –±–æ–ª—å—à–µ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
bot/
  db/          # –ú–æ–¥–µ–ª–∏, DAO, engine
  services/    # –õ–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ –∏ –¥–æ—Å—Ç–∞–≤–∫–∏
  handlers/    # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥
  keyboards/   # Inline –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
  utils/       # –£—Ç–∏–ª–∏—Ç—ã
scripts/       # –°–∫—Ä–∏–ø—Ç—ã –∏–º–ø–æ—Ä—Ç–∞
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

1. `/start` ‚Üí –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–Ω –≤ –ë–î
2. `/today` ‚Üí –ø—Ä–∏—à–ª–æ 5 –≤–æ–ø—Ä–æ—Å–æ–≤
3. –ù–∞–∂–∞—Ç—å "–û—Ç–≤–µ—Ç–∏—Ç—å" ‚Üí –±–æ—Ç –ø—Ä–æ—Å–∏—Ç —Ç–µ–∫—Å—Ç
4. –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç ‚Üí –æ—Ç–≤–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω
5. `/stats` ‚Üí —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±–Ω–æ–≤–∏–ª–∞—Å—å
6. `/today` —Å–Ω–æ–≤–∞ ‚Üí –¥—Ä—É–≥–∏–µ –≤–æ–ø—Ä–æ—Å—ã (–Ω–µ –æ—Ç–≤–µ—á–µ–Ω–Ω—ã–µ)
